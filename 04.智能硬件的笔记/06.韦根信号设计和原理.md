# 06.韦根信号设计和原理
#### 目录介绍
- 01.Wiegand开发是什么
- 02.Wiegand开发注意事项
- 03.Wiegand开发准备
- 04.Wiegand数据格式
- 05.Wiegand26位输出格式
- 06.Wiegand34位输出格式



## 01.Wiegand开发是什么

Wiegand 是一种常用于门禁系统和访问控制系统的数据传输协议。

它使用两根线（通常是一根数据线和一根地线）来传输数据，其中一根线用于传输二进制数据的高电平信号，另一根线用于传输二进制数据的低电平信号。

Wiegand（韦根）协议是由摩托罗拉公司制定的一种通讯协议，门禁系统的读卡器、IC卡常用到这种协议。


## 02.Wiegand开发准备事项

进行 Wiegand 开发，以下是一些步骤和注意事项： 

1. 硬件设备：首先，您需要了解您所使用的硬件设备，例如读卡器和控制器。这些设备通常具有 Wiegand 接口，可以与其他设备进行数据交换。 
2. 数据格式：Wiegand 协议有不同的数据格式，如 26 位【最常见】、34 位、37 位等。您需要了解您所使用的具体数据格式，并根据需要解析和处理相应的数据。 
3. 数据传输：Wiegand 使用两根线来传输数据，一根线用于高电平信号，一根线用于低电平信号。您需要了解如何读取和解析这些信号，并将其转换为可用的数据。 
4. 数据处理：一旦您成功读取到 Wiegand 数据，您可以根据需要进行进一步的处理。这可能包括验证卡片信息、与数据库进行交互、控制门禁设备等。

标准26-bit 格式是一个开放式的格式：

这就意味着任何人都可以购买某一特定格式的HID卡，并且这些特定格式的种类是公开可选的。

26-Bit格式就是一个广泛使用的工业标准，并且对所有HID的用户开放。几乎所有的门禁控制系统都接受标准的26-Bit格式。

## 03.Wiegand开发准备



## 04.Wiegand数据格式

Wiegand 数据格式使用两个独立的线路（通常是一根称为D0的数据线和一根称为D1的数据线）来传输数据，二根线分别将0或1输出。

数据以二进制形式编码，通常由一串0和1的脉冲表示。每个脉冲的持续时间表示一个特定的位（0或1）。输出0时：DATA0线上出现负脉冲； 输出1时：DATA1线上出现负脉冲。

Wiegand 数据格式通常由三个主要部分组成：起始位（Start Bit）、数据位（Data Bits）和校验位（Parity Bit）。

起始位用于标识数据传输的开始，数据位包含实际的用户或卡片数据，而校验位用于验证数据的准确性。

## 05.Wiegand26位输出格式

Wiegand 26位各数据位的含义如下： 

- 第1 位:为输出数据2-13位的偶校验位 
- 第2-9位:ID卡的HID码的低8位 
- 第10-25位:1D卡的PID号码 
- 第 26 位:为输出数据14-25位的奇校验位

例如：一只HID：16385（0x4001），PID：00004的电子卡其26位韦根输出为：

- 第1位为2-13位的偶校验位 ---------------1
- 第2-9位对应与电子卡HID码的低8位 0 0 0 0 0 0 0 1
- 第10-25位对应电子卡的PID号码 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0
- 第26位为14-25位的奇校验位 0

读出的数据是：1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0



## 06.Wiegand34位输出格式
- Wiegand 34位各数据位的含义如下： 
  - 第 1 位： 为输出第2—17位的偶校验位 
  - 第 2-17 位： ID卡的HID码 
  - 第18-33位： ID卡的PID号码 
  - 第 34 位： 为输出第18-33位的奇校验位 
  - 数据输出顺序：HID码和PID码均为高位在前，低位在后。
- 例：一张ID卡内容为： 
  - HID：32769   PID：34953  （假设卡面印字为：2147584137   001   34953 ） 
  - 相应的二进制为： 
  - HID：1000 0000 0000 0001 
  - PID：1000 1000 1000 1001 
- 输出如下：
  ```
  12                     1718                     33  34
  
  0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 0 0 0 10 0 0 1 0 0 0 1 0 0 1   0
  ```



## 参考
- Android系统韦根调试从驱动到应用（一）
  - https://blog.csdn.net/blueheart05/article/details/106116954
- 韦根26和34格式怎么算数据，和开发相关知识。
  - https://blog.csdn.net/pawnxi/article/details/138218873







