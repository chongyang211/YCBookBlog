# 18.CocoaPods搭建仓库
- 01.CocoaPods简单介绍
  - 1.1 遇到问题和需求
  - 1.2 CocoaPods简介
  - 1.3 CocoaPods命令
  - 1.4 共有库的介绍
- 02.CocoaPods使用介绍
  - 2.1 创建iosSpecs仓库
  - 2.2 创建pods工程
  - 2.3 在仓库中添加代码
  - 2.4 Example案例介绍


## 01.CocoaPods简单介绍
### 1.1 遇到问题和需求

问题：在我们日常开发中，难免会用到一些第三方库（比如AFNetworking、SDWebImage...），而这些第三方库也许会引用一些别的第三方库，于是我们又要引入别的第三方库。

另外，如果第三方库更新了，还要手动重新引入新的库。（总之就是很麻烦）

需求：是否能有个工具，能帮助开发者们管理第三方库？在第三方库更新时，能通过一些简单命令，及时更新第三方库？

### 1.2 CocoaPods简介

CocoaPods是开发iOS项目的库管理工具。它拥有超过55,000个库，并在超过300万个应用程序中使用。通过CocoaPods可以帮助我们优雅地扩展项目，便捷的导入第三方开源库。

### 1.3 CocoaPods命令

1. 先通过terminal找到项目目录，并新建Podfile。使用命令：pod init。

2. 打开Podfile文件。使用命令：open Podfile。

3. 搜索需要导入的框架。使用命令：pod search 框架名。

4. 安装第三方框架。使用命令：pod install （PS：如果当前网络状况不好，可以不更新索引库，直接用命令pod install --no-repo-update即可。）

5. 打开.xcworkspace文件，开始编程。（.xcworkspace代替了.xcodeproj）

### 1.4 共有库的介绍

如果我们也想把自己创作的 组件 / 框架 开源出去，给更多的开发者使用，那我们就要把自己的pods发布到CocoaPods里。这样，当别人在用pod search xxx时，就会search到你开源的 组件 / 框架 了。

而一个开源组件/框架，一般需要包含以下几个文件：

- 组件/框架 源码；
- LICENSE：开源许可证（一般选择MIT）；
- README.md：仓库说明（Markdown格式）；
- cocoaPodsName.podspec：CocoaPods的描述文件（很重要）。

## 02.CocoaPods使用介绍

### 2.1 创建iosSpecs仓库

在github上创建一个iosSpecs仓库

具体步骤：登录github --> 点击右上角“+” --> 选择 new repository --> 输入Repository name为 iosSpecs ，选择仓库类型为 private，点击Create repository。

在终端以下执行命令，将仓库添加到 ~/.cocoapods/repos 目录下

```bash
pod repo add iosSpecs https://github.com/xxx/iosSpecs.git
```

### 2.2 创建pods工程

在桌面创建一个test文件夹目录，终端 cd 到 test 目录，执行终端命令

```bash
pod lib create pod_test
```

成功后，会在test目录下创建一个pod_test工程。

```shell
CHONGYYANG-MB1:Downloads yangchong$ pod lib create PalmSDK
Cloning `https://github.com/CocoaPods/pod-template.git` into `PalmSDK`.
Configuring PalmSDK template.

Press return to continue.

//Output：使用的平台
What platform do you want to use?? [ iOS / macOS ]
> iOS

//Output：选择语言
What language do you want to use?? [ Swift / ObjC ]
> Swift

Possible answers are [ Swift / ObjC ]
> Swift

//Output：是否创建演示应用程序Demo
Would you like to include a demo application with your library? [ Yes / No ]
> Yes

//Output：您将使用哪些测试框架？
Which testing frameworks will you use? [ Quick / None ]
> Quick

//Output：需要创建 UI 测试，后续也可以自行加入 Target
Would you like to do view based testing? [ Yes / No ]
> Yes

Running pod install on your new library.
```

### 2.3 在仓库中添加代码

在工程的项目目录下，有一个 ReplaceMe 文件，是存放我们文件的位置，不能直接在项目右键 new->File。

因为这是一个虚拟路径，需要我们手动导航进入 Classes 目录中，可以通过右键 ReplaceMe 文件 Show In Finder，进入到 Classes ，获取路径

### 2.4 Example案例介绍

在 Example 中去使用它，Example 项目安装你的pod，提供给用户使用 Demo

进入 Example 目录，Pod install



## 参考博客

iOS 私有库组件化：CocoaPods搭建私有仓库：https://juejin.cn/post/7468484524902072374

iOS - 公开的 Cocoapods 仓库创建（开源仓库）：https://juejin.cn/post/7347210988259688458

iOS 组件化 使用cocoapods集成实战演练：https://juejin.cn/post/6844903813300617223



