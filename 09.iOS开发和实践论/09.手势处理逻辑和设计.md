# 09.æ‰‹åŠ¿å¤„ç†é€»è¾‘å’Œè®¾è®¡
#### ç›®å½•ä»‹ç»
01.æ‰‹åŠ¿ç±»å‹ä»‹ç»
1.1 æ‰‹åŠ¿çˆ¶ç±»ä»‹ç»
1.2 æ‰‹åŠ¿ç±»æœ‰å“ªäº›
02.æ‰‹åŠ¿å¤„ç†ä½¿ç”¨
2.1 æ‰‹åŠ¿å¤„ç†æ­¥éª¤
2.2 å„ç§æ‰‹åŠ¿ç”¨æ³•
2.3 è§¦æ§äº‹ä»¶ç†è§£
01.æ‰‹åŠ¿ç±»å‹ä»‹ç»
1.1 æ‰‹åŠ¿çˆ¶ç±»ä»‹ç»
åœ¨ iOS ä¸­ï¼ŒUIGestureRecognizer æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†ç”¨æˆ·æ‰‹åŠ¿çš„æŠ½è±¡åŸºç±»ã€‚

å®ƒæä¾›äº†ä¸€ç§ç®€å•çš„æ–¹å¼æ¥æ£€æµ‹å’Œå“åº”ç”¨æˆ·çš„è§¦æ‘¸æ‰‹åŠ¿ï¼Œä¾‹å¦‚ç‚¹å‡»ã€æ»‘åŠ¨ã€æåˆã€æ—‹è½¬ç­‰ã€‚

1.2 æ‰‹åŠ¿ç±»æœ‰å“ªäº›
æ‰‹åŠ¿ç±»å‹(ä»–ä»¬éƒ½ç»§æ‰¿è‡ªUIGestureRecognizerï¼Œè€ŒUIGestureRecognizerç»§æ‰¿è‡ªNSObject)


UIPanGestureRecognizerï¼ˆæ‹–åŠ¨ï¼‰
UIPinchGestureRecognizerï¼ˆæåˆï¼‰
UIRotationGestureRecognizerï¼ˆæ—‹è½¬ï¼‰
UITapGestureRecognizerï¼ˆç‚¹æŒ‰ï¼‰
UILongPressGestureRecognizerï¼ˆé•¿æŒ‰ï¼‰
UISwipeGestureRecognizerï¼ˆè½»æ‰«ï¼‰
02.æ‰‹åŠ¿å¤„ç†ä½¿ç”¨
2.1 æ‰‹åŠ¿å¤„ç†æ­¥éª¤
1.åˆ›å»ºæ‰‹åŠ¿è¯†åˆ«å™¨ï¼šåˆ›å»ºäº†ä¸€ä¸ª UITapGestureRecognizer å®ä¾‹ï¼Œå¹¶æŒ‡å®šäº†ä¸€ä¸ªç›®æ ‡å¯¹è±¡å’Œä¸€ä¸ªå¤„ç†æ–¹æ³•ã€‚


let gestureRecognizer = UITapGestureRecognizer(target: self, action: #selector(handleTap(_:)))
2.æ·»åŠ æ‰‹åŠ¿è¯†åˆ«å™¨åˆ°è§†å›¾ï¼šå°†æ‰‹åŠ¿è¯†åˆ«å™¨æ·»åŠ åˆ°è§†å›¾ä¸­ï¼Œä»¥ä¾¿å®ƒå¯ä»¥æ¥æ”¶ç”¨æˆ·çš„æ‰‹åŠ¿äº‹ä»¶ã€‚


view.addGestureRecognizer(gestureRecognizer)
view.removeGestureRecognizer(gestureRecognizer) //ç§»é™¤æ‰‹åŠ¿
3.å®ç°å¤„ç†æ–¹æ³•ï¼šå®ç°äº†ä¸€ä¸ªåä¸º handleTap(_ğŸ˜ƒ çš„å¤„ç†æ–¹æ³•ï¼Œç”¨äºå¤„ç†æ‰‹åŠ¿äº‹ä»¶ã€‚

è¯·æ³¨æ„ï¼Œå¤„ç†æ–¹æ³•éœ€è¦ä½¿ç”¨ @objc æ ‡è®°ï¼Œå¹¶ä¸”å‚æ•°ç±»å‹å¿…é¡»ä¸æ‰‹åŠ¿è¯†åˆ«å™¨çš„ç±»å‹åŒ¹é…ã€‚


@objc func handleTap(_ gestureRecognizer: UITapGestureRecognizer) {
// å¤„ç†æ‰‹åŠ¿äº‹ä»¶
}
4.å¯é€‰ï¼šé…ç½®æ‰‹åŠ¿è¯†åˆ«å™¨çš„å±æ€§ï¼šè®¾ç½®äº†æ‰‹åŠ¿è¯†åˆ«å™¨çš„ numberOfTapsRequired å±æ€§ä¸º 2ï¼Œè¡¨ç¤ºéœ€è¦åŒå‡»æ‰èƒ½è§¦å‘æ‰‹åŠ¿äº‹ä»¶ã€‚æˆ‘ä»¬è¿˜å°† isEnabled å±æ€§è®¾ç½®ä¸º trueï¼Œä»¥å¯ç”¨æ‰‹åŠ¿è¯†åˆ«å™¨ã€‚


gestureRecognizer.numberOfTapsRequired = 2
gestureRecognizer.isEnabled = true
2.2 å„ç§æ‰‹åŠ¿ç”¨æ³•

@IBOutlet weak var imgView: UIImageView!

var lastScaleFactor: CGFloat = 1
var netRotation: CGFloat = 0
var netTranslation: CGPoint = CGPointMake(0,0)

override func viewDidLoad() {
super.viewDidLoad()

    // ç‚¹å‡»æ‰‹åŠ¿
    let tapGesture = UITapGestureRecognizer(target: self, action: "handleTapGesture:")
    tapGesture.numberOfTapsRequired = 2  // ç‚¹å‡»æ¬¡æ•°
    self.view.addGestureRecognizer(tapGesture)
 
    // ææ‰‹åŠ¿
    let pinchGesture = UIPinchGestureRecognizer(target: self, action: "handlePinchGesture:")
    self.view.addGestureRecognizer(pinchGesture)
    
    // æ—‹è½¬æ‰‹åŠ¿
    let rotateGesture = UIRotationGestureRecognizer(target: self, action: "handleRotateGesture:")
    self.view.addGestureRecognizer(rotateGesture)
    
    // æ»‘åŠ¨æ‰‹åŠ¿: é»˜è®¤ä¸ºå³æ»‘
    let swipeGesture = UISwipeGestureRecognizer(target: self, action: "handleSwipeGesture:")
    swipeGesture.direction = .Down //.Left .Down .Up .Right
    self.view.addGestureRecognizer(swipeGesture)

//    // æ‹–åŠ¨æ‰‹åŠ¿: ä¸æ»‘åŠ¨æ‰‹åŠ¿å†²çªï¼ŒäºŒè€…é€‰å…¶ä¸€
//    let panGesture = UIPanGestureRecognizer(target: self, action: "handlePanGesture:")
//    self.view.addGestureRecognizer(panGesture)

    // é•¿æŒ‰æ‰‹åŠ¿
    let longpressGestrue = UILongPressGestureRecognizer(target: self, action: "handleLongPressGesture:")
    longpressGestrue.minimumPressDuration = 1
    longpressGestrue.numberOfTouchesRequired = 1
    longpressGestrue.allowableMovement = 15
    self.view.addGestureRecognizer(longpressGestrue)
}

override func didReceiveMemoryWarning() {
super.didReceiveMemoryWarning()
}

// MARK: gesture methods

func handleTapGesture(sender: UITapGestureRecognizer) {
print("handleTapGesture")
if imgView.contentMode == UIViewContentMode.ScaleAspectFit {
imgView.contentMode = UIViewContentMode.Center
} else {
imgView.contentMode = UIViewContentMode.ScaleAspectFit
}
}

func handlePinchGesture(sender: UIPinchGestureRecognizer) {
print("handlePinchGesture")
let factor = sender.scale
print("factor", factor)
if factor > 1 { // æ”¾å¤§
imgView.transform = CGAffineTransformMakeScale(lastScaleFactor + factor - 1, lastScaleFactor + factor - 1)
} else { // ç¼©å°
imgView.transform = CGAffineTransformMakeScale(lastScaleFactor * factor, lastScaleFactor * factor)
}
if sender.state == UIGestureRecognizerState.Ended {
if factor > 1 {
lastScaleFactor = lastScaleFactor + factor - 1
} else {
lastScaleFactor = lastScaleFactor * factor
}
}
}

func handleRotateGesture(sender: UIRotationGestureRecognizer) {
print("handleRotateGesture")
let rotation = sender.rotation
print("rotation", rotation)
imgView.transform = CGAffineTransformMakeRotation(rotation + netRotation)
if sender.state == UIGestureRecognizerState.Ended {
netRotation += rotation
}
}

func handleSwipeGesture(sender: UISwipeGestureRecognizer) {
print("handleSwipeGesture")
}

func handlePanGesture(sender: UIPanGestureRecognizer) {
print("UIPanGestureRecognizer")
let translation = sender.translationInView(imgView)
imgView.transform = CGAffineTransformMakeTranslation(netTranslation.x + translation.x, translation.y + netTranslation.y)
if sender.state == UIGestureRecognizerState.Ended {
netTranslation.x += translation.x
netTranslation.y += translation.y
}
}

func handleLongPressGesture(sender: UILongPressGestureRecognizer) {
print("handleLongPressGesture")
if sender.state == UIGestureRecognizerState.Began {
print("----------")
}
}
2.3 è§¦æ§äº‹ä»¶ç†è§£
func touchesBegan(touches: NSSet, withEvent event: UIEvent) é€šçŸ¥è°ƒç”¨è€…å½“æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ‰‹æŒ‡è§¦æ‘¸åˆ°äº†è§†å›¾æˆ–è€…çª—å£æ—¶è§¦å‘æ­¤æ–¹æ³•
func touchesMoved(touches: NSSet, withEvent event: UIEvent) å‘Šè¯‰æ¥æ”¶è€…ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ‰‹æŒ‡åœ¨è§†å›¾æˆ–è€…çª—å£ä¸Šè§¦å‘ç§»åŠ¨äº‹ä»¶
func touchesEnded(touches: NSSet, withEvent event: UIEvent) å½“ä¸€ä¸ªè§¦æ‘¸äº‹ä»¶ç»“æŸæ—¶å‘å‡ºçš„UITouchå®ä¾‹å¯¹è±¡
func touchesCancelled(touches: NSSet, withEvent event: UIEvent) é€šçŸ¥æ¥æ”¶è€…å½“ç³»ç»Ÿå‘å‡ºå–æ¶ˆäº‹ä»¶çš„æ—¶å€™ï¼ˆå¦‚ä½å†…å­˜æ¶ˆè€—çš„å‘Šè­¦æ¡†ï¼‰

override func touchesBegan(touches: Set<UITouch>, withEvent event: UIEvent?) {
for touch: AnyObject in touches {
let tap: UITouch = touch as! UITouch
print("tapCount", tap.tapCount)
print("event begin!")
}
}

override func touchesMoved(touches: Set<UITouch>, withEvent event: UIEvent?) {
for touch: AnyObject in touches {
let tap: UITouch = touch as! UITouch
print(tap.locationInView(self.view))
}
}

override func touchesEnded(touches: Set<UITouch>, withEvent event: UIEvent?) {
print("event end!")
}

override func touchesCancelled(touches: Set<UITouch>?, withEvent event: UIEvent?) {
print("event canceled!")
}




