# 专栏笔记总结大全



## 04.ANR监控设计实践

- 什么是ANR：程序无响应。Android系统对于一些事件需要在一定的时间范围内完成，如果超过预定时间能未能得到有效响应或者响应时间过长，都会造成ANR。
- 为什么要设计ANR：用于检测和处理应用程序无响应的情况。尽管ANR对用户来说可能是一种不愉快的体验，但它的设计是为了确保应用程序的稳定性和用户体验。
- ANR产生条件是什么：主线程超时阻塞；只要在这个时间上限内没有响应就会ANR；输入事件/特定操作没有及时响应也会导致ANR
- ANR触发条件有哪些：1.UI线程在5秒无法响应用户的输入事件；2.广播接收器在10秒钟内无法完成处理；3.服务在20秒钟内无法完成处理；4.输入事件队列阻塞
- 四大组件触发ANR大概步骤：大概是：埋下注册超时 ----> 触发超时 ----> 引发超时ANR
- ANR后执行流程是什么：1.四大组件发生ANR；2.进程接收异常终止信号，开始写入进程ANR信息；3.弹出ANR提示框，提示用户关闭APP或者继续等待
- 极端情况不会ANR有哪些：进程正在处于正在关闭的状态，正在crash的状态，被kill的状态，或者相同进程已经处在ANR的流程中。
- ANR静默和弹窗设计是什么：如何是后台ANR则直接静默杀死App，如果是前台ANR则是弹出系统弹窗提示用户
- 处理ANR信息收集是如何做的：通过分析ANR日志、Traces文件和ANR报告，开发者可以了解ANR发生时的上下文、线程状态和执行情况，从而进行故障排查和性能优化。
- 什么是输入系统：



## 10.高性能图片优化方案

- 1.1 为什么说图片比较占用内存：一个手机拍摄的 2700 * 1900 像素的照片，需要 5.1M 的存储空间，但是在图像解码配置 ARGB_8888 时，它加载到内存需要 19.6M 内存空间
- 1.2 加载网络图片大概流程：1.获取网络资源文件流；2.decodeStream加载到bitmap中；3.然后压缩图片；4.然后处理图片变换；5.图片缓存策略；
- 1.3 三方库加载图片逻辑大概是怎样：从网络拉取图片；然后解码图片；然后进行压缩；接着会有图片常用圆角裁剪等处理；然后三级缓存加载的图片；当然加载图片过程涉及同步加载和异步加载；最后设置到具体view控件上。
- 1.4 BitmapFactory可以加载哪些内容：提供了四类方法来加载Bitmap：decodeFile加载文件、decodeResource加载资源、decodeStream加载流、decodeByteArray加载字节数组。
- 1.5 如何理解图片大小和占用内存：图片大小是经过相对应的压缩算法将原图每个像素点信息转换用另一种数据格式表示；图片内存是这张图片加载进内存所占用的大小。
- 1.6 Bitmap能直接存储吗：bitmap是一个对象，如果要存储成本地可以查看的图片文件，则必须对bitmap进行编码，然后通过io流写到本地file文件上。
- 1.7 Bitmap创建的对象内存分配在哪里：8.0 之前版本为 Bitmap 像素从 Java heap 申请内存。 8.0 版本后为 Bitmap 像素从 Native heap 申请内存。
- 1.8 如果你是谷歌开发，图片框架如何设计：大多数图片框架加载流程，概括来说，图片加载包含封装，解析，下载，解码，变换，缓存，显示等操作。
- 2.1 如何计算图片占用内存：bitmap内存大小 = 图片长度 x 图片宽度 x 单位像素占用的字节数（这个就跟编码方式有关了）
- 2.2 加载本地资源图片占用内存怎么计算：它占用的内存 = width * height * nTargetDensity/inDensity 一个像素所占的内存。
- 2.3 一个像素占用多大内存：ARGB_8888: 每个像素4字节. 共32位，默认设置。RGB_565:共16位，2字节，只存储RGB值。
- 2.5 影响Bitmap内存因素有哪些：图片加载的分辨率；编码格式；设备的屏幕密度等因素。
- 2.6 加载xhdpi和xxhdpi图片有何区别：相同的图片，显示在控件上面所占用内存是不一样的。因为两个文件夹对应的dpi是不一样的。
- 2.7 图片放在res不同目录，加载的内存是一样的吗：在加载 res 目录下的资源图片时，会根据图片存放的不同目录做一次分辨率的转换，新图的高度 = 原图高度 * (设备的 dpi / 目录对应的 dpi )
- 3.1 常见图片压缩有哪些：1.质量压缩不会对内存产生影响；2.内存压缩，按照比例缩小图片加载减少内存占用
- 3.2 如何理解图片尺寸压缩：














