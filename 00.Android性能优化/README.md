# 专栏笔记总结大全



## 04.ANR监控设计实践

- 什么是ANR：程序无响应。Android系统对于一些事件需要在一定的时间范围内完成，如果超过预定时间能未能得到有效响应或者响应时间过长，都会造成ANR。
- 为什么要设计ANR：用于检测和处理应用程序无响应的情况。尽管ANR对用户来说可能是一种不愉快的体验，但它的设计是为了确保应用程序的稳定性和用户体验。
- ANR产生条件是什么：主线程超时阻塞；只要在这个时间上限内没有响应就会ANR；输入事件/特定操作没有及时响应也会导致ANR
- ANR触发条件有哪些：1.UI线程在5秒无法响应用户的输入事件；2.广播接收器在10秒钟内无法完成处理；3.服务在20秒钟内无法完成处理；4.输入事件队列阻塞
- 四大组件触发ANR大概步骤：大概是：埋下注册超时 ----> 触发超时 ----> 引发超时ANR
- ANR后执行流程是什么：1.四大组件发生ANR；2.进程接收异常终止信号，开始写入进程ANR信息；3.弹出ANR提示框，提示用户关闭APP或者继续等待
- 极端情况不会ANR有哪些：进程正在处于正在关闭的状态，正在crash的状态，被kill的状态，或者相同进程已经处在ANR的流程中。
- ANR静默和弹窗设计是什么：如何是后台ANR则直接静默杀死App，如果是前台ANR则是弹出系统弹窗提示用户
- 处理ANR信息收集是如何做的：通过分析ANR日志、Traces文件和ANR报告，开发者可以了解ANR发生时的上下文、线程状态和执行情况，从而进行故障排查和性能优化。
- 什么是输入系统：

## 05.CPU消耗优化实践

- 1.1 如何理解CPU概念：CPU，这里也可以叫做CPU寄存器。一般计算器是多核的，有多个CPU，主要是为了提高计算效率！
- 1.2 从CPU角度理解线程并发：每个CPU核心可以执行一个线程。多核心 CPU 允许同时执行多个线程，从而实现并发处理。
- 1.3 如何理解CPU读写数据：int i = i + 1，当线程执行这个语句时，会先从主内存中读取i的值，然后复制一份到CPU的高速缓存中，然后CPU执行指令对i进行加1的操作，然后将数据写入高速缓存，最后将最新的i值刷新到主存当重。
- 1.4 如何理解CPU使用率：CPU 使用率是指 CPU 在处理任务时所占用时间的比例
- 1.5 CPU优化思路是什么：优化方法论就是：①.减少程序指令数、②.降低每条指令的平均时钟周期、③.降低时钟周期的时间、④.其他优化方案
- 2.2 如何理解CPU总使用率：当CPU总使用率较高时，可能表示系统负荷较重，处理器资源被大量任务占用，可能会导致系统响应速度变慢或出现卡顿现象。
- 2.3 如何理解程序CPU使用率：
- 4.2 如何理解减少CPU等待：有两种情况经常导致 CPU 等待，一是等待锁，二是等待 IO。导致 CPU 无法继续执行后面的代码。





## 10.高性能图片优化方案

- 1.1 为什么说图片比较占用内存：一个手机拍摄的 2700 * 1900 像素的照片，需要 5.1M 的存储空间，但是在图像解码配置 ARGB_8888 时，它加载到内存需要 19.6M 内存空间
- 1.2 加载网络图片大概流程：1.获取网络资源文件流；2.decodeStream加载到bitmap中；3.然后压缩图片；4.然后处理图片变换；5.图片缓存策略；
- 1.3 三方库加载图片逻辑大概是怎样：从网络拉取图片；然后解码图片；然后进行压缩；接着会有图片常用圆角裁剪等处理；然后三级缓存加载的图片；当然加载图片过程涉及同步加载和异步加载；最后设置到具体view控件上。
- 1.4 BitmapFactory可以加载哪些内容：提供了四类方法来加载Bitmap：decodeFile加载文件、decodeResource加载资源、decodeStream加载流、decodeByteArray加载字节数组。
- 1.5 如何理解图片大小和占用内存：图片大小是经过相对应的压缩算法将原图每个像素点信息转换用另一种数据格式表示；图片内存是这张图片加载进内存所占用的大小。
- 1.6 Bitmap能直接存储吗：bitmap是一个对象，如果要存储成本地可以查看的图片文件，则必须对bitmap进行编码，然后通过io流写到本地file文件上。
- 1.7 Bitmap创建的对象内存分配在哪里：8.0 之前版本为 Bitmap 像素从 Java heap 申请内存。 8.0 版本后为 Bitmap 像素从 Native heap 申请内存。
- 1.8 如果你是谷歌开发，图片框架如何设计：大多数图片框架加载流程，概括来说，图片加载包含封装，解析，下载，解码，变换，缓存，显示等操作。
- 2.1 如何计算图片占用内存：bitmap内存大小 = 图片长度 x 图片宽度 x 单位像素占用的字节数（这个就跟编码方式有关了）
- 2.2 加载本地资源图片占用内存怎么计算：它占用的内存 = width * height * nTargetDensity/inDensity 一个像素所占的内存。
- 2.3 一个像素占用多大内存：ARGB_8888: 每个像素4字节. 共32位，默认设置。RGB_565:共16位，2字节，只存储RGB值。
- 2.5 影响Bitmap内存因素有哪些：图片加载的分辨率；编码格式；设备的屏幕密度等因素。
- 2.6 加载xhdpi和xxhdpi图片有何区别：相同的图片，显示在控件上面所占用内存是不一样的。因为两个文件夹对应的dpi是不一样的。
- 2.7 图片放在res不同目录，加载的内存是一样的吗：在加载 res 目录下的资源图片时，会根据图片存放的不同目录做一次分辨率的转换，新图的高度 = 原图高度 * (设备的 dpi / 目录对应的 dpi )
- 3.1 常见图片压缩有哪些：1.质量压缩不会对内存产生影响；2.内存压缩，按照比例缩小图片加载减少内存占用
- 3.2.1 如何理解图片尺寸压缩：原理是通过降低图片的宽度和高度（即减少像素数量），从而减少图片的存储大小。
- 3.2.2 BitmapFactory.Options.inSampleSize核心思想是什么：是通过降低图片的分辨率来减少内存占用。它是在解码阶段生效的，因此它可以在图片加载到内存之前就完成压缩，避免不必要的内存消耗。
- 3.2.3 inJustDecodeBounds这个参数是干什么的：如果设置为true则表示decode函数不会生成bitmap对象，仅是将图像相关的参数填充到option对象里，这样我们就可以在不生成bitmap而获取到图像的相关参数。
- 3.3 如何理解图片质量压缩：通过减少图像文件中像素的细节和信息来降低图像文件大小的技术。这种压缩方法通常会牺牲一定程度的图像质量，以换取更小的文件大小。
- 3.4 如何理解双线性采样压缩：这种压缩方法通过对图像进行插值计算，以平滑地减少图像的像素数量，同时尽可能保留图像的细节和质量。
- 3.5 高清图分片加载的核心思想：将大尺寸的高清图像分割成多个小块（片段），根据显示需求动态加载和拼接这些片段，以实现高清图像的显示。帮助减少内存占用和提高性能，保持高清图像的清晰度。
- 4.1 如何理解RGB色彩模式：一种基于红、绿、蓝三种原色的彩色表示方式，通过不同比例的这三种颜色的组合来表示各种颜色。
- 4.2 如何理解ARGB色彩模式：在 RGB 色彩模式基础上增加了透明度通道，用于控制像素的透明度，提供了更多的图像处理和显示选项。
- 4.3 Android中色彩格式如何选择：1.RGB 格式表示红蓝绿；2.ARGB 格式表示增加一个Alpha透明通道；3.十六进制格式颜色
- 5.1 Android图片内存缓存思想是什么：内存缓存的核心思想是利用内存的高速读写特性，缓存最近使用的图片，从而避免重复加载和减少磁盘 I/O 操作。
- 5.2 Lru内存缓存核心思想是什么：一种基于 最近最少使用（LRU） 策略的缓存算法，广泛应用于内存缓存设计中。其核心思想是通过淘汰最近最少使用的缓存项，来高效管理有限的缓存空间。
- 5.3 Lru缓存注意事项有哪些：
- 6.1 Bitmap演变进程是什么：不同版本对 Bitmap 管理有一些差异，主要涉及到内存管理、资源回收和性能优化等方面。
- 7.1 为何推荐用WebP格式图片：WebP 格式的图片压缩率通常比 JPEG 和 PNG 更高，可以在保证图像质量的前提下显著减少文件大小。支持无损压缩，支持透明度等。
- 7.4 如何处理图片旋转：解决这个问题很自然想到的两步走，首先是要自动识别图像方向，计算旋转角度，然后对图像进行旋转并显示。
- 7.5 如何保存图片到相册：MediaStore 是 Android 提供的一个内容提供者（Content Provider），用于管理设备上的媒体文件（如图片、视频、音频等）。
- 7.6 如何理解统一图片域名优化：将图片资源统一托管在同一个域名下，并结合 CDN（内容分发网络）和图片处理服务，来提升图片加载性能、降低服务器压力、优化用户体验的技术手段。
- 7.7 如何理解优化H5图片加载：通过拦截WebView图片加载的方式，让原生图片库来下载图片之后传递图片二进制数据给WebView显示。



## 17.App页面UI优化实践

- 2.5.1 如何理解RenderThread：是 Android 系统中一个专门用于处理 View 渲染工作的线程，它的引入主要是为了优化渲染效率和提升用户体验。
- 2.5.2 RenderThread和Main线程有何区别：RenderThread专注与View渲染工作，利用GPU硬件加速，主要是做渲染操作然后通过回调把结果通知给主线程。

















